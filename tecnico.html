<!-- tecnico.html -->
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Cadastro de TÃ©cnico - AirControl OS</title>

  <link rel="stylesheet" href="css/style.css">

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest" />
  <meta name="theme-color" content="#1e90ff" />

  <!-- iOS -->
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
</head>
<body>

  <header class="topbar">
    <h1>AirControl OS</h1>
    <button onclick="logout()">Sair</button>
  </header>

  <!-- MENU LATERAL (ATUALIZADO) -->
  <nav class="sidebar">
  <ul>
    <li><a href="dashboard.html">ğŸ  Dashboard</a></li>
    <li><a href="ordem-servico.html">ğŸ“ Ordem de ServiÃ§o</a></li>
    <li><a href="local.html">ğŸ“ Locais</a></li>
    <li><a href="tecnico.html" class="active">ğŸ§‘â€ğŸ”§ TÃ©cnicos</a></li>
    <li><a href="usuarios.html">ğŸ‘¤ UsuÃ¡rios</a></li>
    <li><a href="aparelhos-por-unidade.html">ğŸ¥ Aparelhos por unidade</a></li>
    <li><a href="pmoc.html">âœ… Checklist PMOC</a></li>
    <li><a href="pmoc-historico.html">ğŸ“‚ HistÃ³rico PMOC</a></li>
  </ul>
</nav>

  <main class="main-content">
    <h2>Cadastrar Novo TÃ©cnico</h2>

    <form class="form-os" id="formTecnico">
      <label for="nome">Nome:</label>
      <input type="text" id="nome" name="nome" required>

      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required>

      <label for="telefone">Telefone:</label>
      <input type="tel" id="telefone" name="telefone">

      <!-- Cargo (preenchido via script.js / CARGOS) -->
      <label for="cargo">Cargo (funÃ§Ã£o):</label>
      <select id="cargo" name="cargo"></select>

      <label for="nivel">NÃ­vel de Acesso:</label>
      <select id="nivel" name="nivel" required>
        <option value="Admin">Admin</option>
        <!-- aqui depois vocÃª pode adicionar outros nÃ­veis se quiser -->
      </select>

      <label for="senha">Senha:</label>
      <input type="password" id="senha" name="senha" required>

      <button type="submit" class="tecnico-btn">Salvar TÃ©cnico</button>
    </form>
  </main>

  <!-- script principal -->
  <script src="js/script.js"></script>

  <!-- Bloqueio de acesso: somente Admin -->
  <script>
    // Se existir helper global (que definimos no script.js), usa ele
    if (typeof ensureAdmin === "function") {
      ensureAdmin();
    } else {
      // Fallback: usa o cargo salvo pelo login na sessionStorage
      const cargo = sessionStorage.getItem("cargo");

      if (!cargo) {
        alert("FaÃ§a login para continuar.");
        window.location.href = "index.html";
      } else if (cargo !== "Admin") {   // mesma grafia que vem do backend
        alert("Somente administradores podem acessar esta pÃ¡gina.");
        window.location.href = "dashboard.html";
      }
    }
  </script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js', { scope: './' })
        .catch(err => console.error('SW erro:', err));
    }
  </script>
</body>
</html>
